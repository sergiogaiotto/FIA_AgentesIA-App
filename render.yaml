services:
  - type: web
    name: agentes-ia-fia
    env: python
    plan: free  # Pode ser alterado para starter, standard, pro conforme necessário
    buildCommand: |
      pip install --upgrade pip
      pip install -r requirements.txt
      npm install -g firecrawl-mcp
    startCommand: uvicorn app:app --host 0.0.0.0 --port $PORT
    healthCheckPath: /health
    
    # Configurações de ambiente
    envVars:
      - key: PYTHON_VERSION
        value: "3.11"
      - key: PORT
        value: "8000"
      - key: NODE_VERSION
        value: "18"
      - key: FIRECRAWL_API_KEY
        sync: false  # Será configurada via dashboard do Render
      - key: OPENAI_API_KEY
        sync: false  # Será configurada via dashboard do Render
    
    # Configurações de recurso
    disk:
      name: data
      mountPath: /opt/render/project/data
      sizeGB: 1
    
    # Auto-deploy do branch main
    branch: main
    
    # Configurações de runtime
    runtime: python3
    
    # Headers de segurança personalizados
    headers:
      - path: /*
        name: X-Frame-Options
        value: DENY
      - path: /*
        name: X-Content-Type-Options
        value: nosniff
      - path: /*
        name: Referrer-Policy
        value: strict-origin-when-cross-origin
      - path: /*
        name: Permissions-Policy
        value: geolocation=(), microphone=(), camera=()
    
    # Configurações de saúde
    initialDelaySeconds: 30
    
    # Configurações de build
    buildFilter:
      paths:
        - app.py
        - requirements.txt
        - agents/**
        - static/**
        - templates/**
      ignoredPaths:
        - README.md
        - .gitignore
        - .env*
        - docs/**